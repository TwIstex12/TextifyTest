<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Textify - –ø—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞</title>
    <link rel="stylesheet" href="./css/style.css" />
  </head>
  <body>
    <header class="site-header">
  <div class="logo">
    <h1>Textify</h1>
    <p class="slogan">–ò—Å–ø—Ä–∞–≤—å —Ç–µ–∫—Å—Ç –∑–∞ —Å–µ–∫—É–Ω–¥—É</p>
  </div>
</header>

    <textarea id="user-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–¥–µ—Å—å..."></textarea>
    <button id="analyze-btn">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>

    <div id="result">–¢—É—Ç –ü–æ—è–≤–∏—Ç—Å—è –ì–æ—Ç–æ–≤—ã–π –¢–µ–∫—Å—Ç...</div>
    <script>
  const resultDiv = document.getElementById("result");

  document.getElementById("analyze-btn").addEventListener("click", () => {
    const text = document.getElementById("user-text").value.trim();
    if (!text) {
      resultDiv.innerHTML = "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.";
      return;
    }

    resultDiv.innerHTML = "–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º...";

    fetch("https://api.languagetool.org/v2/check", {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded",
      },
      body: `text=${encodeURIComponent(text)}&language=ru`,
    })
    .then(res => res.json())
    .then(data => {
      if (data.matches && data.matches.length > 0) {
        let correctedText = text;

        // –∏—Å–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å –∫–æ–Ω—Ü–∞
        data.matches.reverse().forEach(match => {
          if (match.replacements.length > 0) {
            const replacement = match.replacements[0].value;
            correctedText =
              correctedText.slice(0, match.offset) +
              replacement +
              correctedText.slice(match.offset + match.length);
          }
        });

        // –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ç–µ–∫—Å—Ç–µ
        let highlightedText = text;
        data.matches.forEach(match => {
          highlightedText =
            highlightedText.slice(0, match.offset) +
            `<span class="highlight">${highlightedText.slice(match.offset, match.offset + match.length)}</span>` +
            highlightedText.slice(match.offset + match.length);
        });

        resultDiv.innerHTML = `<strong>–û—à–∏–±–∫–∏ –ø–æ–¥—Å–≤–µ—á–µ–Ω—ã:</strong><br>${highlightedText}<br><br><strong>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:</strong><br>${correctedText}`;
      } else {
        resultDiv.innerHTML = "–û—à–∏–±–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã üéâ";
      }
    })
    .catch(err => {
      resultDiv.innerHTML = "–û—à–∏–±–∫–∞: " + err;
    });
  });
    </script>
    <h1 class="Alert"> –¢–ï–ö–°–¢ –ú–û–ñ–ï–¢ –ë–´–¢–¨ –ù–ï –ü–†–ê–í–ò–õ–¨–ù–´–ú –ü–û–°–õ–ï –û–ë–†–ê–ë–û–¢–ö–ò –ü–†–û–í–ï–†–¨–¢–ï –¢–ï–ö–°–¢ –ß–¢–û –ë–´ –£–î–û–°–¢–û–í–ï–†–ò–¢–°–Ø –í –ü–†–ê–í–ò–õ–¨–ù–û–°–¢–ò!</h1>
  </body>
</html>
